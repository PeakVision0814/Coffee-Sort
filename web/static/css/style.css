/* =========================================
   ğŸ¨ å…¨å±€å˜é‡ä¸åŸºç¡€è®¾ç½® (Dark Sci-Fi Theme)
   ========================================= */
:root {
    --bg-dark: #0f172a;       /* æ·±è“é»‘èƒŒæ™¯ */
    --panel-bg: #1e293b;      /* é¢æ¿èƒŒæ™¯ */
    --panel-border: #334155;  /* è¾¹æ¡†é¢œè‰² */
    --text-main: #e2e8f0;     /* ä¸»è¦æ–‡å­— */
    --text-muted: #94a3b8;    /* æ¬¡è¦æ–‡å­— */
    --accent-cyan: #06b6d4;   /* é’è‰²å¼ºè°ƒ (AI/ç³»ç»Ÿ) */
    --accent-green: #10b981;  /* ç»¿è‰²çŠ¶æ€ (æ­£å¸¸) */
    --accent-warn: #f59e0b;   /* ç¥ç€è‰² (æ»¡è½½) */
    --accent-danger: #ef4444; /* çº¢è‰² (åœæ­¢/å½•éŸ³) */
}

body {
    background-color: var(--bg-dark);
    color: var(--text-main);
    font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
    background-image: radial-gradient(circle at 50% 0%, #1e293b 0%, #0f172a 70%);
}

/* æ»šåŠ¨æ¡ç¾åŒ– */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #64748b; }

/* å¯¼èˆªæ  */
.navbar {
    background: rgba(15, 23, 42, 0.9) !important;
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--panel-border);
}
.navbar-brand i { color: var(--accent-cyan) !important; }

/* å¡ç‰‡é€šç”¨ */
.card {
    background-color: var(--panel-bg);
    border: 1px solid var(--panel-border);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    color: var(--text-main);
}
.card-header, .card-footer {
    background-color: rgba(30, 41, 59, 0.5) !important;
    border-color: var(--panel-border) !important;
}
.text-muted { color: var(--text-muted) !important; }

/* ç›‘æ§ç”»é¢ */
.monitor-frame {
    background-color: #000;
    border: 1px solid #334155;
    position: relative;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
}
.monitor-frame::after {
    content: " "; display: block; position: absolute; top: 0; left: 0; bottom: 0; right: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none;
}

/* ... å‰é¢çš„å…¨å±€å˜é‡ç­‰ä¿æŒä¸å˜ ... */

/* =========================================
   ğŸ“¦ åº“å­˜ç½‘æ ¼ (æ°´å¹³å¸ƒå±€ä¼˜åŒ–)
   ========================================= */
.slot-box {
    background-color: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--panel-border);
    border-radius: 6px;
    height: 50px; /* é«˜åº¦å‡å° */
    display: flex; 
    flex-direction: row; /* æ¨ªå‘æ’åˆ— */
    justify-content: center; 
    align-items: center;
    gap: 8px; /* å…ƒç´ é—´è· */
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative; overflow: hidden;
    cursor: default;
}

.slot-number { font-size: 0.8rem; color: var(--text-muted); font-weight: bold; position: absolute; left: 5px; top: 2px; font-size: 0.6rem; }
.slot-icon { font-size: 1.2rem; color: #475569; transition: all 0.3s; }
.slot-text { display: none; } /* ç©ºé—´å¤ªå°ï¼Œä¸æ˜¾ç¤º EMPTY/FULL æ–‡å­—ï¼Œåªé é¢œè‰²å’Œå›¾æ ‡ */

/* å·²æ»¡çŠ¶æ€ */
.slot-full {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(245, 158, 11, 0.1) 100%);
    border-color: var(--accent-warn);
    box-shadow: 0 0 8px rgba(245, 158, 11, 0.3);
}
.slot-full .slot-icon { color: var(--accent-warn); transform: scale(1.1); }
.slot-full .slot-number { color: var(--accent-warn); }

/* =========================================
   ğŸ“Ÿ æ—¥å¿—ç»ˆç«¯ (Log Terminal)
   ========================================= */
#log-terminal {
    background: #000;
    scrollbar-width: thin;
    scrollbar-color: #333 #000;
}
.log-line {
    margin-bottom: 2px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    padding-bottom: 2px;
    word-wrap: break-word;
}
/* ä¸åŒç±»å‹çš„æ—¥å¿—é¢œè‰² */
.log-info { color: #10b981; }  /* ç»¿è‰² */
.log-warn { color: #f59e0b; }  /* é»„è‰² */
.log-err { color: #ef4444; }   /* çº¢è‰² */
.log-sys { color: #06b6d4; }   /* é’è‰² */

/* ... å…¶ä»–èŠå¤©ã€ç›‘æ§ CSS ä¿æŒä¸å˜ ... */
/* =========================================
   ğŸ’¬ èŠå¤©åŒºåŸŸ (Bubble Style ä¼˜åŒ–ç‰ˆ)
   ========================================= */

.ai-panel { border-radius: 12px; overflow: hidden; }

/* èƒŒæ™¯å¸¦ç‚¹é˜µçº¹ç† */
.chat-container {
    background-color: #0f172a;
    background-image: radial-gradient(#334155 1px, transparent 1px);
    background-size: 20px 20px;
    display: flex; flex-direction: column; gap: 20px; padding: 20px;
}

/* æ¶ˆæ¯è¡Œå¸ƒå±€ */
.chat-row { display: flex; align-items: flex-start; gap: 12px; width: 100%; animation: messageSlideIn 0.3s ease-out; }
.chat-row.user { flex-direction: row-reverse; } /* ç”¨æˆ·åœ¨å³ */
.chat-row.ai { flex-direction: row; }           /* AI åœ¨å·¦ */
.chat-row.system { justify-content: center; }   /* ç³»ç»Ÿå±…ä¸­ */

/* æ°”æ³¡é€šç”¨æ ·å¼ */
.chat-message {
    padding: 12px 18px;
    max-width: 75%; /* é™åˆ¶å®½åº¦ï¼Œæ›´æœ‰æ°”æ³¡æ„Ÿ */
    position: relative;
    line-height: 1.6;
    font-size: 0.95rem;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    word-wrap: break-word;
}

/* ğŸ¤– AI æ°”æ³¡ (å·¦ä¾§) */
.chat-message.ai {
    background-color: rgba(30, 41, 59, 0.95); /* æ·±ç°ç£¨ç ‚ */
    border: 1px solid var(--panel-border);
    color: var(--text-main);
    
    /* æ ¸å¿ƒï¼šéå¯¹ç§°åœ†è§’ - å·¦ä¸Šè§’ç›´è§’ */
    border-radius: 2px 18px 18px 18px; 
}

/* ğŸ‘¤ ç”¨æˆ·æ°”æ³¡ (å³ä¾§) */
.chat-message.user {
    background: linear-gradient(135deg, var(--accent-cyan) 0%, #0284c7 100%); /* é’è“æ¸å˜ */
    color: #fff;
    
    /* æ ¸å¿ƒï¼šéå¯¹ç§°åœ†è§’ - å³ä¸‹è§’ç›´è§’ */
    border-radius: 18px 18px 2px 18px;
    
    box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3); /* å‘å…‰æ•ˆæœ */
}

/* ç³»ç»Ÿæ¶ˆæ¯ (å±…ä¸­èƒ¶å›Š) */
.chat-message.system {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 50px;
    font-size: 0.8rem;
    padding: 5px 20px;
    border: 1px solid var(--panel-border);
    color: var(--text-muted);
    max-width: 90%;
    text-align: center;
}

/* å¤´åƒæ ·å¼ */
.avatar { 
    width: 42px; height: 42px; border-radius: 50%; 
    display: flex; justify-content: center; align-items: center; 
    flex-shrink: 0; color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    font-size: 1.1rem;
}
.avatar.ai { background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); border: 2px solid #1e293b; }
.avatar.user { background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: 2px solid #1e293b; }

/* åŠ¨ç”»å®šä¹‰ */
@keyframes messageSlideIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* æ‰“å­—æœºå…‰æ ‡ç‚¹ */
.typing-indicator { display: inline-flex; align-items: center; margin-left: 4px; height: 1em; }
.typing-dot {
    width: 4px; height: 4px; border-radius: 50%; background-color: var(--accent-cyan);
    margin: 0 2px; animation: typing 1.4s infinite ease-in-out both;
}
.typing-dot:nth-child(1) { animation-delay: -0.32s; }
.typing-dot:nth-child(2) { animation-delay: -0.16s; }
@keyframes typing { 0%, 80%, 100% { transform: scale(0); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }

/* æ¶ˆæ¯è¿½åŠ æ ·å¼ */
.system-append-span { font-weight: normal; color: inherit; }
.system-append-span.error { color: #fca5a5; font-weight: bold; }


/* =========================================
   ğŸ¤ æ§ä»¶ä¸è¾“å…¥æ¡†
   ========================================= */
#btn-mic {
    transition: all 0.3s;
    border-radius: 50%;
    width: 48px; height: 48px;
    padding: 0; display: flex; align-items: center; justify-content: center;
    margin-right: 10px;
    background-color: transparent;
    border: 1px solid var(--panel-border);
    color: var(--text-muted);
}
#btn-mic:hover { background-color: rgba(255,255,255,0.05); color: white; }

/* å½•éŸ³æ³¢çº¹åŠ¨ç”» */
@keyframes ripple {
    0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
    70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
    100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
}
.mic-active {
    background-color: var(--accent-danger) !important;
    border-color: var(--accent-danger) !important;
    color: white !important;
    animation: ripple 1.5s infinite;
}

#user-input {
    background-color: rgba(15, 23, 42, 0.5);
    border: 1px solid var(--panel-border);
    color: white; border-radius: 24px;
}
#user-input:focus {
    background-color: rgba(15, 23, 42, 0.8);
    border-color: var(--accent-cyan);
    box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
}
#user-input::placeholder { color: #64748b; }
#btn-send { border-radius: 24px; padding-left: 25px; padding-right: 25px; }